<xmp service="runJS">
    function(script){
        $t.refs.script[0].value=script;
        $t.refs.ret[0].innerHTML=eval(script);
        $t.ui.growpanel.parts[0].max();
    }
</xmp>
<xmp>
    <div id="header_wrap" class="outer">
        <div class="zidx3 abs">
            <set lazy append class="bgray15" style="font-family: 微软雅黑;">
                <ui:growpanel title="JS控制台" extend="0">
                    <div class="mdip2">
                        <textarea ref="script" class="fz18 bgray2 wem20 hem5 fgray15 bdw0 rdip5 pdip5" style="outline-width: 0; resize:none;"></textarea>
                        <br/>
                        <ui:button text="运行 >:_">
                            <script>
                                $t.refs.ret[0].innerHTML=eval($t.refs.script[0].value);
                            </script>
                        </ui:button>
                        <br/>
                        <textarea ref="ret" class="rdip5 bgray2 fgray15 fz18 bgray2 w100 hem10 fgray15 bdw0" style="outline-width: 0; resize:none;"></textarea>
                    </div>
                </ui:growpanel>
                
                <ui:panel title="组件树"></ui:panel>
            </set>
            
        </div>
        <header class="inner">
          <h1 id="project_title">Turtlejs（龟计算）</h1>
          <h2 id="project_tagline">make it for fun（预览版）</h2>
          博客用turtlejs编写，所有页面未进行压缩，方便查看源码学习
          <a target="_blank" : href:="'view-source:'+window.location.href">查看本页源码</a>
          <ui:button text="查看组件树">
            <script>
                function refresh(){
                    var elems=[];
                    var elem;
                    function append(cpns,space){
                        for(var i=0;i<cpns.length;i++){
                            var elem=document.createElement("div");
                            elem.innerHTML='&lt;ui:'+cpns[i].template.partName+'&gt;props='+JSON.stringify(cpns[i].props);
                            elem.style.paddingLeft=space+"em";
                            
                            elems.push(elem);
                            
                            var elem2=document.createElement("a");
                            elem2.href="javascript:;";
                            elem2.innerHTML="移除";
                            (function(c){
                                elem2.onclick=function(){
                                    c.remove();
                                    refresh();
                                }
                            })(cpns[i]);
                            
                            elem.insertBefore(elem2,elem.childNodes[0]);
                            
                            
                            var c=cpns[i].child;
                            if(c.length>0){
                                append(c,space+2);
                            }
                        }
                    }
                    append($t.rootParts,0);
                    var tree=$t.ui.panel.parts[0];
                    tree.show();
                    tree.setContent(elems);
                }
                refresh()
            </script>
          </ui:button>
          <!! $t.ui.panel.parts[0].hide();>
        </header>
        
    </div>
</xmp>
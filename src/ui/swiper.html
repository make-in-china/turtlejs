<xmp ui="swiper.script">
    <style> 
        .swiper-container {
            width: 100%;
            height: 100%;
        }
    </style>
    <link rel="stylesheet" href="css/swiper-3.3.1.min.css">
    <script>
        var ready=new $t.ReadyObject();
        var swiper;
        $t.service.swiper=function(container,wrapper,content,slideClass){
            if(slideClass){
                slideClass=slideClass.split(" ");
            }else{
                slideClass=[];
            }
            var opn;
            if(content[0].nodeName==="SCRIPT" && content[0].type==="option"){
                opn=$t.fn.execByScope(this,'('+content[0].innerHTML+')',null,outer,content)
                content.shift();
            }
            if(!opn.slideClass){
                opn.slideClass="swiper-slide";
            }
            slideClass.push(opn.slideClass);
            var lst=content;
            for(var i=0;i<lst.length;i++){
                $t.addClasses(lst[i],slideClass);
            }
            if(opn.slidesPerColumn>0){
                var p=$t.toPercent(1/opn.slidesPerColumn);
                if(opn.direction&&opn.direction==='vertical'){
                    for(var i=0;i<lst.length;i++){
                        lst[i].style.width=p;
                    }
                }else{
                    for(var i=0;i<lst.length;i++){
                        lst[i].style.height=p;
                    }
                }
            }
            $t.appendNodes(content,wrapper);
            controls={nextButton:"swiper-button-next",
                    prevButton:"swiper-button-prev",
                    scrollbar:"swiper-scrollbar",
                    pagination:"swiper-pagination"};
            if(opn){
                for(var i in controls){
                    if(i in opn){
                        var div=document.createElement('div');
                        div.className=controls[i];
                        if(/^\./.test(opn[i])){
                            div.className+=" "+opn[i].substring(1,opn[i].length);
                        }
                        container.appendChild(div);    
                    }
                }
            }
            $t.initHTML(wrapper.childNodes);
            $t.readyByRenderDocument.on(function(){
                ready.on(function(){
                    new swiper(container,opn);
                }); 
            });
        };
        swiper=$t.require("js/swiper-3.3.1.min.js","Swiper");
        ready.isReady=true;
        /*$t.includeJSFiles("js/swiper-3.3.1.min.js",function(){
            swiper=Swiper;
            delete window.Swiper; 
            ready.isReady=true;
        });*/
        
    </script>
</xmp>
<xmp>
    <div key="container" class="swiper-container">
        <div key="wrapper" class="swiper-wrapper">
        </div>
    </div>
    <script var="container,wrapper">
        var slideClass="{slideclass!}";
        if(!$t.service.swiper){
            var t=this;
            $t.renderBefore("swiper.script",t.childNodes[0],outer,outerElement);
        }
        $t.service.swiper(container,wrapper,outerElement,slideClass);
    </script>
</xmp>
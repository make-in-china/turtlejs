var turtle,$t;!function(){document.write("<style>xmp,[type=xmp]{display:none}</style>");var Arrayprototype=Array.prototype,Objectprototype=Object.prototype,hasOwnProperty=Object.prototype.hasOwnProperty,slice=Arrayprototype.slice,getPrototypeOf=Object.getPrototypeOf,appendChild=Node.prototype.appendChild,readyRE=/complete|loaded|interactive/,memberRE=/{[a-zA-Z\d\.\%\u4e00-\u9fa5]+\!?(['"]?)-?[a-zA-Z\d\.\%\u4e00-\u9fa5]*?\1\!?(['"]?)-?[a-zA-Z\d\.\%\u4e00-\u9fa5]*?\2}/g,orderRE=/^\s?(if|while|for|switch|break|-|scope|content|bind|!|var|=)(\s|$)/g,orderCaseRE=/^\s?(else if|else|case break|case|default|end)(\s|$)/g,operatorRE=/\!=|==|=|<|>|\|/,camelCaseRE=/-(\w)/g,_OrderBlockStack=newArrayObject("OrderBlockStack"),isIE=!!window.ActiveXObject||"ActiveXObject"in window;"classList"in document.documentElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){var e=this;function t(t){return function(n){var r=e.className.split(/\s+/g),i=r.indexOf(n);t(r,i,n),e.className=r.join(" ")}}return{add:t(function(e,t,n){~t||e.push(n)}),remove:t(function(e,t){~t&&e.splice(t,1)}),toggle:t(function(e,t,n){~t?e.splice(t,1):e.push(n)}),contains:function(t){return!!~e.className.split(/\s+/g).indexOf(t)},item:function(t){return e.className.split(/\s+/g)[t]||null}}}}),function(){var e=Node.prototype.insertBefore;isIE?Node.prototype.insertBefore2=function(t,n){var r,i=[];switch(t.nodeType){case 3:if(""===t.data)return;case 8:for(r=n.nextSibling;null!==r;)i.push(this.removeChild(r)),r=n.nextSibling;i.unshift(this.removeChild(n)),this.appendChild(t);for(var o=0;o<i.length;o++)this.appendChild(i[o]);break;default:e.call(this,t,n)}}:Node.prototype.insertBefore2=e}();var require=function(){var e=newHashObject("RequireHash");function t(e){this.file=e,this.injectInvoke=Function(e+"\r\n;return function(s){return eval('('+s+')');};")()}return function(n,r){if(isArray(n)){var i=n.join(",");if(e.hasOwnProperty(i))return e[i].injectInvoke(r);for(var o="",a=0;a<n.length;a++)$t.xhr.get(n[a],!1,function(e){o+="\r\n"+e});var c=e[i]=new t(o);return c.injectInvoke(r)}if(e.hasOwnProperty(n))return e[n].injectInvoke(r);var s;return $t.xhr.get(n,!1,function(i){var o=e[n]=new t(i);s=o.injectInvoke(r)}),s}}();function requireByScript(e,t){return Function(e+"\r\n;return function(s){return eval('('+s+')');};")()(t)}function log(s){eval("console.log(s)")}function bp(){eval("debugger;")}var lowercase,uppercase;"i"!=="I".toLowerCase()?(lowercase=function(e){return isString(e)?e.replace(/[A-Z]/g,function(e){return String.fromCharCode(32|e.charCodeAt(0))}):e},uppercase=function(e){return isString(e)?e.replace(/[a-z]/g,function(e){return String.fromCharCode(e.charCodeAt(0)&~32)}):e}):(lowercase=function(e){return isString(e)?e.toLowerCase():e},uppercase=function(e){return isString(e)?e.toUpperCase():e});function FatFunction(e){var t=e.split("=>");if(2==t.length&&/^\(.*?\)$/.test(t[0])){var n=t[0].substring(1,t[0].length-1);return Function(n,'return eval("'+t[1]+'");')}}function isBlankObject(e){return null!==e&&"object"===typeof e&&!getPrototypeOf(e)}function forEach(e,t,n,r){var i,o;if(void 0===r&&(r=!0),e)if(isFunction(e))for(i in e)"prototype"==i||"length"==i||"name"==i||e.hasOwnProperty&&!e.hasOwnProperty(i)||t.call(n,r?e[i]:null,i,e);else if(isArray(e)||isArrayLike(e)){var a="object"!==typeof e;for(i=0,o=e.length;i<o;i++)(a||i in e)&&t.call(n,r?e[i]:null,i,e)}else if(e.forEach&&e.forEach!==forEach)e.forEach(t,n,e);else if(isBlankObject(e))for(i in e)t.call(n,r?e[i]:null,i,e);else if("function"===typeof e.hasOwnProperty)for(i in e)e.hasOwnProperty(i)&&t.call(n,r?e[i]:null,i,e);else for(i in e)hasOwnProperty.call(e,i)&&t.call(n,r?e[i]:null,i,e);return e}function removeNode(e){var t=e.parentNode;return t?e.parentNode.removeChild(e):null}function isArrayLike(e){if(null==e||isWindow(e))return!1;if(isArray(e)||isString(e))return!0;var t="length"in Object(e)&&e.length;return isNumber(t)&&(t>=0&&(t-1 in e||e instanceof Array)||"function"==typeof e.item)}function forEachSorted(e,t,n){for(var r=Object.keys(e).sort(),i=0;i<r.length;i++)t.call(n,e[r[i]],r[i]);return r}function _catch(e,t){isFunction(t)?t(e):isFunction($t.event.onerror)&&$t.event.onerror(e)}function _try(e){var t=slice.call(arguments,1);try{this.apply(e,t)}catch(n){_catch(n)}}function getTry(e){return function(){try{return e.apply(this,arguments)}catch(t){_catch(t)}}}function onTry(e,t){var n=slice.call(arguments,2);try{this.apply(e,n)}catch(r){_catch(r,t)}}function handleWebkitRrror(e){var t=e.stack,n=t.split("\n");n.shift();for(var r=0;r<n.length;r++){var i=n[r].split(":");if(i.length>1){var o=i[i.length-1].replace(")",""),a=i[i.length-2];i=i[i.length-3].split("/"),i[i.length-1]=i[i.length-1].replace("html","h").replace("js","s"),n[r]="at "+i[i.length-1]+":"+a+":"+o}else n[r]=i[0].replace(/(^\s*)|(\s*$)/g,"")}return n.join("\r\n")}function getFileNameByURL(e){return e.match(/[a-zA-Z\d\.]+\.[a-zA-Z\d]+$/)[0]}function getNameByURL(e){return e.match(/[a-zA-Z\d\.]+\.[a-zA-Z\d]+$/)[0].replace(/\.[a-zA-Z\d]+$/,"")}function getNameByLocation(){return getFileNameByURL(window.location.href)}function getOnTry(e){var t=slice.call(arguments,1);return function(){for(var n=slice.call(t),r=0;r<arguments.length;r++)n.push(arguments[r]);try{return e.apply(this,n)}catch(i){_catch(i)}}}function $$(e){return document.getElementById(e)}function getBind(e,t){return function(){return t.apply(e,arguments)}}function getBindTry(e,t){return function(){try{return t.apply(e,arguments)}catch(n){_catch(n)}}}function getStateFunction(e){var t=function(){return t.enable?e.apply(this,arguments):void 0};return t.enable=!0,t}function hasCustomToString(e){return isFunction(e.toString)&&e.toString!==toString}function getDPI(){var e,t=document.createElement("div");return t.style.height="1em",document.body.appendChild(t),e=t.scrollHeight,t.style.height="16px",e/=t.scrollHeight,document.body.removeChild(t),e}function getClosure(e){var t=arguments;return function(){for(var n=toArray(t),r=0;r<arguments.length;r++)n.push(arguments[r]);return e.apply(this,n)}}function toArray(e){return slice.call(e)}function getKeyArray(e){var t=[];return forEach(e,function(e,n){t.push(n)},this,!1),t}function _resetDescriptor(e,t){var n;for(var r in e){if(n=Object.getOwnPropertyDescriptor(e,r),!n)return;n.configurable===!1&&throwError("重置"+name+"失败：configurable==false"),n.writable===!1&&throwError("重置"+name+"失败：writable==false"),n.hasOwnProperty("value")?t.value=n.value:(n.hasOwnProperty("get")&&(t.get=n.get),n.hasOwnProperty("set")&&(t.set=n.set)),Object.defineProperty(e,r,t)}}function lockObject(e){var t={writable:!1,enumerable:!0,configurable:!1};_resetDescriptor(e,t)}function lockObject2(e){var t={writable:!0,enumerable:!1,configurable:!1};_resetDescriptor(e,t)}function objectChange(e,t){for(var n in e)onPropertyChange(e,n,t)}function onPropertyChange(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(r){r.configurable===!1&&throwError("绑定失败：原属性"+t+"替换失败"),r.writable===!1&&throwError("绑定失败：原属性"+t+"不可写"),delete e[t];var i,o={enumerable:r.enumerable,configurable:!0};if(r.hasOwnProperty("value")){var a=r.value;isFunction(a)?(o.get=function(){return a.call(this,i)},o.set=function(r){i!=r&&(i=r,a.call(this,i),n.call(e,t))}):(o.get=function(){return a},o.set=function(r){a!=r&&(a=r,n.call(e,t))})}else{if(r.hasOwnProperty("get")){var c=r.get;o.get=function(){return c.call(this)}}if(r.hasOwnProperty("set")){var s=r.set;o.set=function(r){s.call(this,r),n.call(e,t)}}}Object.defineProperty(e,t,o),r=null}}function objectPropertyChange(e,t,n){e.hasOwnProperty(t)&&onPropertyChange(e,t,n)}function removeItem(e,t){var n=e.indexOf(t);n!=-1&&e.splice(n,1)}function addBindInfo(e,t,n,r,i){var o=e.__bind__;o||(o=[],e.__bind__=o),o.push({name:t,target:n,targetName:r,event:i})}function removeBind(e,t,n){if(!e.__bind__)return!1;var r=e.__bind__;for(var i in r)if(r[i].name===t&&r[i].targetName===n)return 1==r.length?(r.length=0,delete e.__bind__):r.splice(i,1),!0;return!1}function bindPropertyByName(e,t,n,r){var i=function(e){if(!i.isBinding){i.isBinding=!0;for(var t=0;t<i.list.length;t++){var n=i.list[t];if(n!==this){var r=n.__bind__;for(var o in r)r[o].targetName===e&&(n[r[o].name]=this[e])}}i.isBinding=!1}};return i.isBinding=!1,i.removeObject=function(e){removeItem(i.list,e)},i.list=[e,n],addBindInfo(e,t,n,r,i),addBindInfo(n,r,e,t,i),i}function camelCase(e){return e.replace(camelCaseRE,function(e,t){return t.toUpperCase()})}function bindElementProperty(e,t,n,r){bindProperty(e,t,n,r,2)}var bindProperty;!function(){function e(e,t,n){if(e.__bind__){var r=e.__bind__;for(var i in r)if(r[i].name===t&&r[i].targetName===n)return r[i]}}bindProperty=function(t,n,r,i,o){var a=e(t,n,i),c=e(r,i,n);if(a&&c&&a.event!==c.event)return void throwError("不能混合不同的绑定链");if(a){var s=a.event;addBindInfo(r,i,t,n,s),s.list.push(r),2!=o&&(onPropertyChange(r,i,s),s.isBinding=!0,r[i]=t[n],s.isBinding=!1)}else if(c){var s=c.event;addBindInfo(t,n,r,i,s),s.list.push(t),onPropertyChange(t,n,s),s.isBinding=!0,t[n]=r[i],s.isBinding=!1}else{var s=bindPropertyByName(t,n,r,i);onPropertyChange(t,n,s),2!=o&&(onPropertyChange(r,i,s),s.isBinding=!0,r[i]=t[n],s.isBinding=!1)}}}();function parseBool(e){return"string"==typeof e&&(e=e.replace(/[\s]/g,"").toLowerCase(),!e||"false"!=e&&"0"!=e&&"null"!=e&&"undefined"!=e?e&&(e=!0):e=!1),!!e}function addClass(e,t){var n;e&&(n=e.classList,n.contains(t)||n.add(t))}function addClasses(e,t){var n;if(e){n=e.classList;for(var r=0;r<t.length;r++)n.contains(t[r])||n.add(t[r])}}function removeClass(e,t){var n;e&&(n=e.classList,n.contains(t)&&n.remove(t))}function removeClasses(e,t){var n;if(e){n=e.classList;for(var r=0;r<t.length;r++)n.contains(t[r])&&n.remove(t[r])}}function replaceClass(e,t,n){e&&t&&n&&(e.className=e.className.replace(t,n))}function toggleClass(e,t,n,r){e&&t&&(e.className.indexOf(t)>=0?(e.className=e.className.replace(t,""),r&&r()):(e.className+=" "+t,n&&n()))}function _rpl(e,t,n){return t.toLowerCase()+"-"+n.toLowerCase()}function dasherize(e){return e.replace(/::/g,"/").replace(/([a-z\d])([A-Z])/g,_rpl).replace(/([A-Z]+)([A-Z][a-z])/g,_rpl)}function scriptToJSON(e){return JSON.parse(e.replace(/([a-zA-Z\d]+?)(?=:)/g,function(e){return'"'+e.substring(0,e.length)+'"'}))}var _toString={}.toString;function isRegExp(e){return"[object RegExp]"===_toString.call(e)}function isDate(e){return"[object Date]"===_toString.call(e)}function isNumber(e){return"[object Number]"===_toString.call(e)}function isString(e){return"[object String]"===_toString.call(e)}function isFunction(e){return"[object Function]"===_toString.call(e)}function isObject(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function isFinite(e){return isFinite(e)&&!isNaN(parseFloat(e))}function isUndefined(e){return e===void 0}var isArray=Array.isArray||function(e){return"[object Array]"===_toString.call(e)};function isArrayLike(e){return"number"==typeof e.length}function compact(e){return e.filter(function(e){return void 0!==e&&null!==e})}function flatten(e){return e.length>0?[].concat.apply([],e):e}function camelize(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})}function trim(e){return e.replace(/^\s*/g,"").replace(/\s*$/g,"")}function trimLine(e){return e.replace(/^\s*/g,"").replace(/\s*$/g,"").replace(/\s*[\r\n]\s*/g,"")}function isRepeat(e){var t={};for(var n in e){if(e[n]in t)return!0;t[e[n]]=void 0}return!1}function moveArray(e,t){for(var n=0;n<e.length;n++)t.push(e[n])}function getRect(e){for(var t={left:0,top:0,right:0,bottom:0},n=document.body,r=e;r&&r!=n;)t.left+=r.offsetLeft,t.top+=r.offsetTop,r=r.parentNode;return t.right=t.left+e.offsetWidth,t.bottom=t.top+e.offsetHeight,t}function each(e,t){var n,r;if(isArrayLike(e)){for(n=0;n<e.length;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(r in e)if(t.call(e[r],r,e[r])===!1)return e;return e}function map(e,t){var n,r,i,o=[];if(isArrayLike(e))for(r=0;r<e.length;r++)n=t(e[r],r),null!=n&&o.push(n);else for(i in e)n=t(e[i],i),null!=n&&o.push(n);return flatten(o)}var _en_decode=document.createElement("div");function encodeHTML(e){_en_decode.innerText=e;var t=_en_decode.innerHTML;return _en_decode.innerHTML="",t}function decodeHTML(e){_en_decode.innerHTML=e;var t=_en_decode.innerText;return _en_decode.innerHTML="",t}function idle(e){var t=0;return function(n){t>0&&clearTimeout(t),n||(n=0),t=setTimeout(function(){t=0,biz.trycall(e)},n)}}function insertNode(e,t){var n=e.parentNode;return null==n?0:(n.insertBefore2(t,e),0)}function repeatCall(e,t,n){var r=0;id=setInterval(function(){r++,t!=-1&&r>=t&&clearInterval(id),n()},e)}function takeChildNodes(e){for(var t=e.childNodes,n=t.length,r=[],i=n;i>0;i--)r.push(e.removeChild(t[0]));return r}function toPercent(e){return(Math.round(1e4*e)/100).toFixed(0)+"%"}function takeOutChildNodes(e){var t=e.parentNode;if(null==t)return 0;for(var n=e.childNodes,r=0,i=n.length-1;i>-1;i--)t.insertBefore2(e.removeChild(n[0]),e);return t.removeChild(e),r}function elementDOMdistance(e,t,n){for(var r=0,i=0;1&&t!==e;)r++,t=t.parentNode;for(;1&&n!==e;)i++,n=n.parentNode;return i-r}function elementInElement(e,t,n){for(n||(n=document.body);1&&e!==n;){if(e===t)return!0;e=e.parentNode}return!1}function debounce(e){var t=0;return function(n){t>0||(n||(n=0),t=setTimeout(function(){t=0,biz.trycall(e)},n))}}function takeAttr(e,t,n){if(e.hasAttribute(t)){var r=e.getAttribute(t);return e.removeAttribute(t),r}return n}function getAttr(e,t,n){return e.hasAttribute(t)?e.getAttribute(t):n}function extendConst(e,t){for(var n in t)Object.defineProperty(e,n,{value:t[n],writable:!1,enumerable:!0,configurable:!1});return e}function extend(e,t){for(var n in t)e[n]=t[n];return e}var _includeTask=null;function setIncludeTaskDone(e,t){_includeTask=e.parent,null!=_includeTask&&(_includeTask.child=null),e.child=null,isFunction(t)&&t()}function IncludeTask(e,t,n){if(this.files=[],this.child=null,this.parent=e,null!=e&&(this.parent.child=this),this.isallload=!1,this.onallload=function(){this.isallload=!0,null==this.child?setIncludeTaskDone(this,n):this.child.isallload&&setIncludeTaskDone(this,n),null!=this.parent&&this.parent.onchildallload()},this.onchildallload=function(){this.isallload&&setIncludeTaskDone(this,n)},this.count=0,isArray(t))for(i in t){var r=t[i];!isString(r)||r in $t.jsScript||(this.files.push(r),$t.jsScript[r]=document.createElement("script"))}else t&&(r=t,!isString(r)||r in $t.jsScript||(this.files.push(r),$t.jsScript[r]=document.createElement("script")))}function includeJSFiles(e,t){_includeTask=new IncludeTask(_includeTask,e,t),includeJSFile(_includeTask)}function includeJSFile(e){if(e.files.length>0){var t=e.files.shift(),n=$t.jsScript[t];n.src=t,e.count++,n.onload=function(){e.count--,includeJSFile(e)},document.head.appendChild(n)}else 0==e.count&&e.onallload()}function newObject(type,prototype){var t;return eval("var "+type+"=function(){};t="+type),isObject(prototype)&&(t.prototype=prototype),new t}function newArrayObject(type){return eval("var "+type+"=function(){};"+type+".prototype=Array.prototype;new "+type+"();")}function newHashObject(e){return newObject(e,newHashObject.prototype)}newHashObject.prototype={clean:function(){for(var e in this)delete this[e]}};function XHR(){function e(e,t,n,r,i,o){var a=new XMLHttpRequest;a.open(e,t,!!r),a.onreadystatechange=function(){4==a.readyState&&(200!==a.status&&0!==a.status||a.responseText.length>0&&i(a.responseText))},"POST"==e&&a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onerror=o,a.send(n)}var t={get:function(t,n,r,i){e("GET",t,void 0,n,r,i)},post:function(t,n,r,i,o){e("POST",t,n,r,i,o)}};return t}function treeEach(e,t,n,r){if(isArrayLike(e)){for(var i,o,a,c=e,s=r>=0?r:0,l=[],u={next:1};1;)if(s<c.length){if(i=c[s],u.next=1,a=n(i,u),void 0==a)a=0;else if(a==treeEach.c_stopEach)break;o=c[s],!o||o==i||treeEach.c_noRepeat&a||(a|=treeEach.c_repeat),o&&o[t]&&o[t].length>0&&!(a&treeEach.c_noIn)&&t?(l.push(c),l.push(s+(a&treeEach.c_repeat?0:u.next)),s=0,c=o[t]):s+=a&treeEach.c_repeat?0:u.next}else{if(!(l.length>0))break;s=l.pop(),c=l.pop()}return{stack:l,state:a,array:c,index:s}}}treeEach.c_stopEach=1,treeEach.c_repeat=2,treeEach.c_noIn=4,treeEach.c_noRepeat=8,lockObject(treeEach);function nodesToString(e){for(var t="",n=0;n<e.length;n++)if(8===e[n].nodeType)t+="<!--"+e[n].data+"-->";else if(3===e[n].nodeType)try{t+=e[n].data}catch(r){}else 1===e[n].nodeType&&(t+=e[n].outerHTML);return t}function replaceNodeByNodes(e,t){insertNodesBefore(e,t),removeNode(e)}function replaceNodeByNode(e,t){var n=e.parentNode;null!=n&&(insertNode(e,t),n.removeChild(e))}function insertNodesBefore(e,t){var n=e.parentNode;if(null!=n)for(var r=0;r<t.length;r++)n.insertBefore2(t[r],e)}function appendNodes(e,t){for(var n=toArray(e),r=0;r<n.length;r++)t.appendChild(n[r])}function getQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null}function appendQueryString(e,t){return window.location.search?window.location.href+"&"+e+"="+t:window.location.href+"?"+e+"="+t}function replaceNodeByString(e,t){var n=e.parentNode;null!=n&&(e.insertAdjacentText("beforeBegin",t),n.removeChild(e))}function parseBreak(e,t,n,r,i){initHTML(e.childNodes,t,n,r,i),takeOutChildNodes(e)}function parseGet(e,t,n,r,i){var o=getAttr(e,"name");return o&&(o=o,initHTML(e.childNodes,t,n,r,i),$t.getNode[o]=e),removeNode(e),treeEach.c_noIn}function execOnScript(node,outerChildNodes,outerElement,props,component){var p=node.parentNode;if(p){var script=node.innerHTML;if(script.length>0){var events;eval("events={"+script+"}");for(var i in events)isFunction(events[i])&&p.addEventListener(i,events[i])}}}function execScript(e,t,n,r,i){var o=e.innerHTML;if(o.length>0){var a,c=getAttr(e,"name",null),s=getUIName(e.parentNode);c&&(s+="."+c);var l=String(getAttr(e,"var",""));a=Function("outer,outerElement,props,component"+(l?",":"")+l,o);var u=[t,n,r,i];if(l.length>0){l=l.split(",");for(var d=0;d<l.length;d++){var p=$t.refNode[l[d]];u.push(p?p[p.length-1]:null)}}try{a.apply(e.parentNode,u)}catch(f){_catch(f)}a=null}}function execTurtleScript(e,t,n,r,i){var o=getAttr(e,"type",null);"on"==o?execOnScript(e,t,n,r,i):execScript(e,t,n,r,i)}function execTemplateScript(e,t,n,r,i,o){return e=e.replace(/{%.+?%}/g,function(e){return execByScope(t,e.substring(2,e.length-2),null,n,r,i,o)})}function getScopeBy(e,t){return e?e:$t.uiScope.get(t)}function execByScope(e,t,n,r,i,o,a){return _execByScope.call(getScopeBy(n,e),t,e,r,i,o,a)}function _execByScope(s,node,outer,outerElement,props,component){with(this)return eval(arguments[0])}function execScope(e,t,n,r,i,o){execByScope(t,"extend(this,{"+e+"});",null,n,r,i,o)}function parseScript(e,t,n,r,i){if(""==e.type||"on"==e.type||"text/javascript"==e.type){var o=getAttr(e,"src","");o?includeJSFiles(o):execTurtleScript(e,t,n,r,i),removeNode(e)}}function _getBindObject(e,t){for(var n=t.length;e;){for(var r=e,i=0;i<n;i++)if(r.hasOwnProperty(t[i])){if(i<n-1){r=r[t[i]];continue}return r}e=e.__parent__}return null}function splitByOnce(e,t){var n=e.indexOf(t),r=[];return n!=-1?(r.push(e.substring(0,n)),r.push(e.substring(n+t.length,e.length))):r.push(e),r}function bindPropertyByOrder(e,t){var n=splitByOnce(t,"|");if(!(n.length<2)){var r,i,o,a,c,s,l=n[0],u=n[1];l=l.indexOf(".")!=-1?l.split("."):[l],r=l[l.length-1],i=$t.uiScope.get(e),o=_getBindObject(i,l),u=u.indexOf(".")!=-1?u.split("."):[u],a=u[u.length-1],c=$t.uiScope.get(e),s=_getBindObject(c,u),bindProperty(o,r,s,a),s[a]=o[r]}}function _execExpressionsByScope(s,v,node){var arg={v:v,node:node};with(this)return eval(arguments[0])}function bindExpressionsByOrder(e,t){var n=splitByOnce(t,"|");n.length<2&&n.push("v");var r,i,o,a,c=n[0],s=document.createTextNode("");c=c.indexOf(".")!=-1?c.split("."):[c],r=c[c.length-1],i=$t.uiScope.get(e),o=_getBindObject(i,c),a=function(t){try{return _execExpressionsByScope.call(i,n[1],t,e)}catch(r){_catch(r)}},a.__that__=a,$t.bindProperty(o,r,a,"__that__"),replaceNodeByNode(e,s),bindElementProperty(a,"__that__",s,"data"),s.data=a.__that__}function bindNodeProperty(e,t,n){var r,i,o,a,c=splitByOnce(n,"|"),s=e,l=c[0],u=camelCase(t);if(u.indexOf(".")!=-1){u=u.split(".");for(var d=0;d<u.length-1;d++)if(s=s[u[d]],!s)return;u=u[u.length-1]}l=l.indexOf(".")!=-1?l.split("."):[l],r=l[l.length-1],i=$t.uiScope.get(e),o=_getBindObject(i,l),2==c.length?(a=function(t){s[u]=execNodeValueEval(t,e,c[1])},a.__that__=a,bindProperty(o,r,a,"__that__")):(bindElementProperty(o,r,s,u),s[u]=o[r])}function execNodeValueEval(v,node,s){with(this)return eval(s)}function bindElementPropertyByName(e,t,n){var r,i,o=splitByOnce(n,"|"),a=o[0];a&&(r=$t.uiScope.get(e),a.indexOf(".")!=-1?(a=a.split("."),obj=_getBindObject(r,a),a=a[a.length-1]):obj=_getBindObject(r,[a]),obj&&(2==o.length?(i=function(t){execNodeValueEval(t,e,o[1])},i.__that__=i,bindProperty(obj,a,i,"__that__")):(e.__bind__||(e[t]=obj[a]),bindProperty(obj,a,e,t))))}function bindNode(e,t){var n,r,i,o,a,c=splitByOnce(t,"|"),s=c[0];if(s&&(n=$t.uiScope.get(e),s.indexOf(".")!=-1?(s=s.split("."),r=_getBindObject(n,s),s=s[s.length-1]):r=_getBindObject(n,[s]),r))if(2==c.length)i=function(t){execNodeValueEval(t,e,c[1])},i.__that__=i,bindProperty(r,s,i,"__that__");else{switch(e.nodeName){case"SELECT":o="value",a="change";break;case"TEXTAREA":o="value",a="input";break;case"INPUT":switch(e.type){case"checkbox":o="checked",a="click";break;default:o="value",a="input"}break;case"#text":o="data";break;case"BUTTON":case"DIV":default:o="innerHTML"}e.__bind__||(e[o]=r[s]),bindElementProperty(r,s,e,o),a&&e.addEventListener(a,function(){r[s]=e[o]})}}function throwError(e){try{throw new Error(e)}catch(t){_catch(t)}}function replaceByObjectAttr(e,t){var n=[];return e=e.replace(memberRE,function(e){var r,i,o;return e=e.substring(1,e.length-1),r=/\!/.test(e),r&&(e=e.split("!"),i=e[1],e.length>2&&(o=e[2]),e=e[0]),t.hasOwnProperty(e)?o?o:t[e]:r?i:void n.push("不可缺少"+e+"属性")}),n.length>0&&2==$t.config.debugMode&&alert(n.join("\r\n")),e}function replaceByNodeAttr(e,t){var n=[];return e=e.replace(memberRE,function(e){var r,i,o;return e=e.substring(1,e.length-1),r=/\!/.test(e),r&&(e=e.split("!"),i=e[1],e.length>2&&(o=e[2]),e=e[0]),t.hasAttribute(e)?o?o:t.getAttribute(e):r?i:void n.push(getUIName(t)+"不可缺少"+e+"参数")}),n.length>0&&2==$t.config.debugMode&&alert(n.join("\r\n")),e}function parseDefine(e){switch(!0){case e.hasAttribute("service"):defineServiceByNode(e);break;case e.hasAttribute("ui"):defineUIByNode(e);break;case e.hasAttribute("class"):defineClasses(e)}}function getUIName(e){if(/UI:[A-Z\d]+/.test(e.nodeName)){var t=e.nodeName.toLowerCase();return t.substring(3,t.length)}return"SCRIPT"==e.nodeName&&"ui"==getAttr(e,"type")?e.getAttribute("name").toLowerCase():void 0}var getCommentText;getCommentText=Comment.prototype.hasOwnProperty("text")?function(e){var t=e.text;return/^<!--([\s\S]*?)-->$/.test(t)?t.substring(4,t.length-3):/^<!([\s\S]*?)>$/.test(t)?t.substring(2,t.length-1):e.text.replace(/^!-?|-?&/)}:function(e){return e.data};function getCommentStringInfo(e){var t=e.match(orderRE);if(t)return{order:trim(t[0]),condition:e.substring(t[0].length,e.length)};var n=e.match(orderCaseRE);return n?{orderCase:trim(n[0]),condition:e.substring(n[0].length,e.length)}:void 0}function parseCommentOrderBlock(e,t,n,r,i){var o=getNodeIndex2(e),a=!1,c=function(e){return a=!0,alert(e),treeEach.c_stopEach};return treeEach(e.parentNode.childNodes,"childNodes",function(e,o){if(8==e.nodeType){var a=getCommentStringInfo(getCommentText(e));if(a){if(a.order){var s=parseCommentOrderNoScript(a,e,t,n,r,i);return s&&(o.next=s.index-getNodeIndex2(e)+1),treeEach.c_noRepeat+treeEach.c_noIn}return"end"==a.orderCase?_OrderBlockStack.length>0?(_OrderBlockStack.pop().endNode=e,treeEach.c_stopEach):c("语法错误：多余的end"):treeEach.c_noIn}}},o+1)}function deepClone(e){for(var t=e.cloneNode(),n=e.childNodes,r=0;r<n.length;r++)t.appendChild(deepClone(n[r]));return t}function cloneBewtween(e,t){for(var n=[],r=getNodeIndex2(e),i=getNodeIndex2(t),o=e.parentNode,a=r+1;a<i;a++)n.push(deepClone(o.childNodes[a]));return n}function takeBlockBetween(e,t){var n=e.parentNode,r=n.childNodes,i=getNodeIndex2(e)+1;l2=getNodeIndex2(t);for(var o=[],a=i;a<l2;a++)o.push(n.removeChild(r[i]));return o}function removeBlockBetween(e,t){var n=e.parentNode,r=getNodeIndex2(e)+1;l2=getNodeIndex2(t);for(var i=r;i<l2;i++)n.removeChild(n.childNodes[r])}function parseComment(e,t,n,r,i){var o=getCommentStringInfo(getCommentText(e));if(o){if(!o.order)return void alert("语法错误：不恰当的"+o.orderCase);parseCommentOrder(o,e,t,n,r,i),e.order&&e.order.endNode&&e.order.run()}}function parseSwitchOrder(e,t,n,r,i,o){return addOrderToNode(t,e,n,r,i,o,function(){return{value:execByScope(t,e.condition,null,n,r,i,o),hit:null,needBreak:!1,endHit:null,hasDefault:!1,run:function(){var e=this,a=$t.uiScope.get(t);treeEach(t.parentNode.childNodes,"childNodes",function(t,c){if(8==t.nodeType){var s=getCommentStringInfo(getCommentText(t));if(s){if(t.order)return void(c.next=getNodeIndex2(t.order.endNode)-getNodeIndex2(t));switch(s.orderCase){case"case":case"case break":if(e.hasDefault)return error("语法错误：default后不应出现case/case break");if(e.hit)e.endHit||(e.endHit=t);else{var l=e.value==execByScope(t,s.condition,a,n,r,i,o);l&&(e.hit=t,t.order=s.orderCase)}break;case"default":if(e.hasDefault)return error("语法错误：多余的default");e.hasDefault=!0,e.hit?e.endHit||(e.endHit=t):(e.hit=t,t.order=s.orderCase)}}}},getNodeIndex2(t)+1);var c=this.node.parentNode;if(this.hit){this.endHit||(this.endHit=this.endNode),removeBlockBetween(this.node,this.hit);var s=takeBlockBetween(this.hit,this.endHit);insertNodesBefore(this.node,s),removeNode(this.hit),"case break"!==this.hit.order&&this.endHit!==this.endNode||(removeBlockBetween(this.node,this.endNode),c.removeChild(this.node),c.removeChild(this.endNode))}else removeBlockBetween(this.node,t),c.removeChild(this.node),c.removeChild(this.endNode);delete this.node.order}}})}function parseBreakOrder(e,t,n,r,i,o){var a=t.previousSibling;a||(a=t.parentNode),removeNode(t);for(var c=a.parentNode;"__BREAK__"!=a.nodeName;){for(var s=c.childNodes,l=s.length,u=getNodeIndex2(a)+1,d=u;d<l;d++)c.removeChild(s[u]);a=c,c=c.parentNode}a.source.onBreak()}function parseIfOrder(e,t,n,r,i,o){return addOrderToNode(t,e,n,r,i,o,function(){var e=$t.uiScope.get(t);return{endHit:null,hit:null,hasElse:!1,run:function(){var a=this;a.hit=parseBool(execByScope(t,this.condition,e,n,r,i,o))?this.node:null,treeEach(t.parentNode.childNodes,"childNodes",function(t,c){if(8==t.nodeType){var s=getCommentStringInfo(getCommentText(t));if(s){if(t.order)return void(c.next=getNodeIndex2(t.order.endNode)-getNodeIndex2(t));switch(s.orderCase){case"else":case"else if":if(a.hasElse)return error("语法错误：else或else if不能出现在else后");"else"==s.orderCase&&(a.hasElse=!0),a.endHit||(a.hit?a.endHit=t:"else"==s.orderCase||parseBool(execByScope(t,this.condition,e,n,r,i,o))?a.hit=t:removeNode(t))}}}},getNodeIndex2(t)+1);var c=this.node.parentNode;if(this.hit){this.endHit||(this.endHit=this.endNode);var s=takeBlockBetween(this.hit,this.endHit);insertNodesBefore(this.node,s),removeBlockBetween(this.node,this.endNode),c.removeChild(this.node),c.removeChild(this.endNode)}else removeBlockBetween(this.node,this.endNode),c.removeChild(this.node),c.removeChild(this.endNode)}}})}function addOrderToNode(e,t,n,r,i,o,a){var c;return e.order?c=e.order:(c=a(),e.order=c,c.name=t.order,c.node=e,c.endNode=null,c.condition=t.condition,_OrderBlockStack.push(c),c.parseCommentOrderBlockReturnValue=parseCommentOrderBlock(e,n,r,i,o)),c.parseCommentOrderBlockReturnValue}function parseWhileOrder(e,t,n,r,i,o){return addOrderToNode(t,e,n,r,i,o,function(){return{run:function(){var e=this.node.parentNode;if(this.isBreak||!parseBool(execByScope(this.node,this.condition,null,n,r,i,o)))removeBlockBetween(this.node,this.endNode),e.removeChild(this.node),e.removeChild(this.endNode);else{var t=cloneBewtween(this.node,this.endNode);this.node.parentNode.insertBefore2(createBreakElement(t,this),this.node)}},onBreak:function(){this.isBreak=!0},isBreak:!1}})}function parseForOrder(e,t,n,r,i,o){return addOrderToNode(t,e,n,r,i,o,function(){var a;return a=/[a-zA-Z\d] in .*/.test(e.condition)?new function(){var a,c=e.condition.split(" in "),s=0,l=[];return function(){if(!a){if(a=execByScope(t,c[1],null,n,r,i,o),!a)return{result:!1,params:null};for(var e in a)l.push(e);if(0==l.length)return{result:!1,params:null}}return s<l.length?(execByScope(t,c[0]+"='"+l[s]+"';",null,n,r,i,o),s++,{result:!0,params:null}):{result:!1,params:null}}}:/^.*;.*;.*$/.test(e.condition)?new function(){var a=!0,c=e.condition.split(";");return 2==c.length?function(){return{result:!1,params:null}}:function(){return a?(a=!1,execByScope(t,c[0],null,n,r,i,o)):execByScope(t,c[2],null,n,r,i,o),{result:execByScope(t,c[1],null,n,r,i,o),params:null}}}:function(){return{result:!1,params:null}},{check:a,run:function(){var e=this.node.parentNode,t=this.check();if(this.isBreak||!t.result)removeBlockBetween(this.node,this.endNode),e.removeChild(this.node),e.removeChild(this.endNode);else{var n=cloneBewtween(this.node,this.endNode);this.node.parentNode.insertBefore2(createBreakElement(n,this),this.node)}},onBreak:function(){this.isBreak=!0},isBreak:!1}})}function createBreakElement(e,t){for(var n=document.createElement("__break__"),r=0;r<e.length;r++)n.appendChild(e[r]);return n.source=t,n}function parseCommentOrderNoScript(e,t,n,r,i,o){switch(e.order){case"while":return parseWhileOrder(e,t,n,r,i,o);break;case"if":return parseIfOrder(e,t,n,r,i,o);break;case"for":return parseForOrder(e,t,n,r,i,o);break;case"switch":return parseSwitchOrder(e,t,n,r,i,o)}}function parseScopeOrder(e,t,n,r,i,o){var a=splitByOnce(e.condition,"|");2==a.length?($t.uiScope.create(t,a[0]),execScope(a[1],t,n,r,i,o)):$t.uiScope.create(t,a[0]),removeNode(t)}function parseCommentOrder(e,t,n,r,i,o){switch(e.order){case"scope":parseScopeOrder(e,t,n,r,i,o);break;case"var":execScope(e.condition,t,n,r,i,o),removeNode(t);break;case"bind":bindPropertyByOrder(t,e.condition);break;case"-":bindExpressionsByOrder(t,e.condition);break;case"!":execByScope(t,e.condition,null,n,r,i,o),removeNode(t);break;case"=":var a=execByScope(t,e.condition,null,n,r,i,o);replaceNodeByNodes(t,[document.createTextNode(a)]);break;case"content":replaceNodeByNodes(t,n);break;case"while":return parseWhileOrder(e,t,n,r,i,o);break;case"if":return parseIfOrder(e,t,n,r,i,o);break;case"break":return parseBreakOrder(e,t,n,r,i,o);break;case"for":return parseForOrder(e,t,n,r,i,o);break;case"switch":return parseSwitchOrder(e,t,n,r,i,o)}}function getLastOrder(e){var t=_OrderBlockStack;if(0==t.length)return null;var n=t[t.length-1];return n.name==e?n:null}function parseTemp(e){var t=parseXMP(e);replaceNodeByNodes(e,t)}function parseLazy(e,t,n,r,i){e.removeAttribute("lazy"),initHTML(e.childNodes,t,n,r,i)}var elementParser={GET:parseGet,SET:parseSet,__BREAK__:parseBreak,SCRIPT:parseScript},attributeParser={ref:function(e,t,n,r,i){$t.refNode.push(e.getAttribute("ref"),e),e.removeAttribute("ref")},":":function(e,t,n,r,i){execNodeQuestion(e,t,n,r,i),setQuestionAtrr(e,t,n,r,i)},bind:function(e,t,n,r,i){bindNode(e,takeAttr(e,"bind"))},remove:function(e,t,n,r,i){bindRemove(e,takeAttr(e,"remove"),t,n,r,i)},add:function(e,t,n,r,i){bindAdd(e,takeAttr(e,"add"),t,n,r,i)},show:function(e,t,n,r,i){bindShowHide(e,takeAttr(e,"show"),!0,t,n,r,i)},hide:function(e,t,n,r,i){bindShowHide(e,takeAttr(e,"hide"),!1,t,n,r,i)},cls:function(e,t,n,r,i){$t.clsNode.push(e)}};function initHTML(e,t,n,r,i){treeEach(e,"childNodes",function(e,o){if(8!==e.nodeType){if(1===e.nodeType){if(e.hasAttribute("lazy"))return parseLazy(e,t,n,r,i),treeEach.c_repeat;if(isUI(e))return parseUI(e,o,i),treeEach.c_noIn|treeEach.c_noRepeat;if(elementParser.hasOwnProperty(e.nodeName)){var a=elementParser[e.nodeName](e,t,n,r,i);if(a)return a}for(var c=slice.call(e.attributes),s=0;s<c.length;s++)attributeParser.hasOwnProperty(c[s].name)&&attributeParser[c[s].name](e,t,n,r,i)}}else try{parseComment(e,t,n,r,i)}catch(l){_catch(l)}})}function defineClasses(e){
$t.styleClasses.push(getAttr(e,"class"),trimLine(getTemplate(e))),removeNode(e)}function hasAttrOnce(e,t){return e.hasAttribute(t)?(e.removeAttribute(t),!0):!1}function parseSet(e,t,n,r,i){var o=e.attributes;if(e.hasAttribute("link")){var a=takeAttr(e,"link");$t.getNode.hasOwnProperty(a)&&1==e.children.length?(appendNodes($t.getNode[a].childNodes,e.children[0]),takeOutChildNodes(e)):removeNode(e)}else{var c;if(e.children.length>0)c=e.children;else{if(!e.parentNode)return;c=[e.parentNode]}var s=!e.hasAttribute("append");e.removeAttribute("append");for(var l=0;l<c.length;l++)if(s)for(var u=0;u<o.length;u++)c[l].setAttribute(o[u].name,o[u].value);else for(var u=0;u<o.length;u++){var d=o[u].value;switch(o[u].name){case"class":var p=c[l].getAttribute(o[u].name);p&&(d=p+" "+d)}c[l].setAttribute(o[u].name,d)}takeOutChildNodes(e)}return treeEach.c_noIn}function setNodeProperty(e,t,n,r,i,o,a){var c=execByScope(e,n,null,r,i,o,a),s=camelCase(t.substr(0,t.length-1));if(s.indexOf(".")!=-1){var l=e;s=s.split(".");for(var u=0;u<s.length-1;u++)if(l=l[s[u]],!l)return;s=s[s.length-1],l[s]=c}else e.setAttribute(s,c)}function bindNodeFunction(e,t,n){var r,i,o,a;return t=t.indexOf(".")!=-1?t.split("."):[t],r=t[t.length-1],i=$t.uiScope.get(e),o=_getBindObject(i,t),a={fn:n},bindProperty(o,r,a,"fn"),{object:o,name:r,targetObject:a,targetName:"fn"}}function execValueByScope(e,t,n,r,i,o,a,c){return _execValueByScope.call(getScopeBy(r,e),t,n,e,i,o,a,c)}function _execValueByScope(s,v,node,outer,outerElement,props,component){var arg={node:node,v:v,outer:outer,outerElement:outerElement,props:props,component:component};with(this)return eval(arguments[0])}function bindEval(e,t,n,r,i,o,a){var c,s=t.match(operatorRE)[0],l=splitByOnce(t,s);if(!(l.length<2)){switch(s){case"|":c=l[1];break;case"=":s="==";default:c="v"+s+l[1]}return bindNodeFunction(e,l[0],function(t){a.call(this,execValueByScope(e,c,t,this,n,r,i,o))})}}function bindShowHide(e,t,n,r,i,o,a){bindEval(e,t,r,i,o,a,function(t){t?n?removeClass(e,"uhide"):addClass(e,"uhide"):n?addClass(e,"uhide"):removeClass(e,"uhide")})}function bindRemove(e,t,n,r,i,o){var a=bindEval(e,t,n,r,i,o,function(t){t&&(removeBind(this,a.targetName,a.name),removeNode(e))})}function bindAdd(e,t,n,r,i,o){var a=document.createComment("");replaceNodeByNode(e,a);var c=bindEval(e,t,n,r,i,o,function(t){t&&(removeBind(this,c.targetName,c.name),replaceNodeByNode(a,e))})}function execNodeQuestion(e,t,n,r,i){var o=takeAttr(e,":");o.length>0&&execByScope(e,o,null,t,n,r,i)}function setQuestionAtrr(e,t,n,r,i){for(var o=slice.call(e.attributes),a=0;a<o.length;a++){var c=o[a].name;c.length>1&&(":"===c[c.length-1]?setNodeProperty(e,c,takeAttr(e,c),t,n,r,i):":"===c[0]&&bindNodeProperty(e,c.substring(1,c.length),takeAttr(e,c)))}}function UIParam(e,t,n,r){this.name=e,this.isDefault=t,this.defaultValue=n,this.limitValue=r}function UITemplate(e,t,n){var r=this;if(r.params=[],r.datas=[],r.components=[],r.isInnerUI=parseBool(n),isObject(t))return void extend(r,t);var i=0,o=0;t.replace(memberRE,function(e,t,n,a,c){var s,l,u,d,p;return p=e.substring(1,e.length-1),s=/\!/.test(p),s?(p=p.split("!"),l=p[1],p.length>2&&(u=p[2]),d=p[0]):d=p,o++,r.params.push(new UIParam(d,s,l,u)),r.datas.push(c.substring(i,a)),i=a+e.length,""}),r.datas.push(t.substring(i,t.length)),r.service=new Service,r.name=e,r.componentName=r.name.replace(/[\.]/g,"_")}UITemplate.prototype={renderIn:function(e,t,n,r,i){isArray(t)||(t=[]),isArray(n)||(n=[]);var o=document.createElement("ui:render");return e&&e.appendChild(o),this.render(o,e,t,n,r,i)},renderBefore:function(e,t,n,r,i){isArray(t)||(t=[]),isArray(n)||(n=[]);var o=document.createElement("ui:render");return e&&e.parentNode&&e.parentNode.insertBefore2(o,e),this.render(o,e,t,n,r,i)},render:function(e,t,n,r,i,o){var a=slice.call(this.datas),c=[];e||(e=document.createElement("ui:render")),setQuestionAtrr(e,n,r,i,o),isObject(i)||(i={});for(var s=e.attributes,l=s.length,u=0;u<l;u++){var d=s[0].name;i.hasOwnProperty(d)||(i[d]=s[0].value),e.removeAttributeNode(s[0])}for(var u=0;u<a.length-1;u+=2){var p,f=this.params[u/2];i.hasOwnProperty(f.name)?p=f.limitValue?f.limitValue:i[f.name]:f.isDefault?p=f.defaultValue:(c.push(this.name+"不可缺少"+f.name+"参数"),p=void 0),a.splice(u+1,0,p)}if(c.length>0)return void(2==$t.config.debugMode&&alert(c.join("\r\n")));var o=newComponent(this,e,execTemplateScript(a.join(""),t,n,r,i,o),n,r,i,o);return this.components.push(o),null!==e.parentNode&&o.insertBefore(e),removeNode(e),o}};function newComponent(e,t,n,r,i,o,a){var c=newObject(e.componentName,newComponent.prototype),s=e.name;t.innerHTML=n;var l=c.begin=document.createComment("<"+s+">"),u=c.end=document.createComment("</"+s+">");u.component=l.component=c,l.sign=1,u.sign=0,c.props=o,c.template=e,c.onInsert=null,c.isInsert=!1;var d=t.childNodes;initHTML(d,r,i,o,c),c.store=slice.call(d),c.store.unshift(l),c.store.push(u);for(var p=d.length;p>0;p--)t.removeChild(d[0]);return c}newComponent.prototype={toString:function(){return this.template.componentName+":"+JSON.stringify(this.props)},treeDiagram:function(e){void 0===e&&(e=0);for(var t="\r\n"+new Array(e+1).join(" ")+this.toString(),n=this.child,r=0;r<n.length;r++)t+=n[r].treeDiagram(e+8);return t},get elements(){if(this.isInsert){for(var e=[],t=this.begin.nextSibling;t!==this.end;){e.push(t);var t=t.nextSibling}return e}return this.store.slice().splice(1,this.store.length-2)},get child(){return getComponents(this.elements)},get parent(){for(var e=this.begin;1;){if(null!==e.previousSibling)e=e.previousSibling;else{if(null===e.parentNode)return null;e=e.parentNode}if(8===e.nodeType&&e.component){if(0!==e.sign)return e.component;e=e.component.begin}}},insertBefore:function(e){if(this.isInsert){var t=this.elements;t.unshift(this.begin),t.push(this.end);for(var n=this.scopeNodes,r=0;r<n.length;r++)$t.uiScope.cut(n[r].scope);insertNodesBefore(e,t);for(var r=0;r<n.length;r++)$t.uiScope.link(n[r].scope,e);isFunction(this.onInsert)&&this.onInsert(e)}else{insertNodesBefore(e,this.store);for(var n=this.scopeNodes,r=0;r<n.length;r++)$t.uiScope.link(n[r].scope,e);isFunction(this.onInsert)&&this.onInsert(e),this.isInsert=!0}},remove:function(){if(this.isInsert){var e=this.elements;e.unshift(this.begin),e.push(this.end);for(var t=this.scopeNodes,n=0;n<t.length;n++)$t.uiScope.cut(t[n].scope);var r=this.begin.parentNode;if(null!==r)for(var n=0;n<e.length;n++)r.removeChild(e[n]);this.store=e,this.isInsert=!1}},get scopeNodes(){var e=[];return treeEach(this.elements,"children",function(t){return t.hasOwnProperty("scope")?(e.push(t),treeEach.c_noIn):void 0}),e}};function RootComponents(){var e=getComponents(document.body.childNodes);return Object.defineProperty(e,"treeDiagram",{get:function(){for(var t=0,n="",r=0;r<e.length;r++)n+=e[r].treeDiagram(t+2);return n}}),e}function getComponents(e){var t=[],n=null;return treeEach(e,"childNodes",function(e){return 8===e.nodeType&&e.component?void(null!==n?e.component===n&&0===e.sign&&(t.push(e.component),n=null):n=e.component):null!==n?treeEach.c_noIn:void 0}),t}function defineServiceByNode(e){name=e.getAttribute("service"),name&&(nodeName=e.getAttribute("ui"),nodeName?$t.ui.hasOwnProperty(nodeName)?$t.ui[nodeName].service.define(name,getTemplate(e)):throwError("不能定义service："+name+"到"+nodeName+"上"):$t.service.hasOwnProperty(name)?throwError("不能重复定义service："+name):$t.service.define(name,getTemplate(e))),removeNode(e)}function defineUIByNode(e){var t=getAttr(e,"ui");t&&$t.ui.define(t,getTemplate(e),!0),removeNode(e)}function parseUITemplate(e,t){var n=document.createElement("ui:parseUITemplate");n.innerHTML=t;for(var r,i,o,a=n.children,c=0;c<a.length;c++){if(r=a[c],!isTemplate(r))return void alert('最上层必须是ui/service模板标签，\r\n模板标签包含（xmp,template,title和含type="xmp"的script,style,textarea）');r.hasAttribute("service")?(defineServiceByNode(r),c--):(i=getTemplate(r),o=r.getAttribute("ui"),o||(o=e),$t.ui.hasOwnProperty(o)?alert("不能重复定义ui："+o):$t.ui.define(o,i))}}function importUIJS(uiName){if(!$t.ui.hasOwnProperty(uiName))for(var paths=$t.config.baseUIPath,data=null,i=0;i<paths.length;i++)if($t.xhr.get(paths[i]+"/"+(uiName+".js").toLowerCase(),!1,function(e){data=e}),null!==data){eval(data);break}return $t.ui[uiName]}function getService(e){return $t.service.hasOwnProperty(e)||$t.xhr.get($t.config.baseServicePath+"/"+(e+".js").toLowerCase(),!1,function(t){$t.service.define(e,t)}),$t.service[e]}function importUIHTML(e){if(!$t.ui.hasOwnProperty(e))for(var t=$t.config.baseUIPath,n=null,r=0;r<t.length;r++)if($t.xhr.get(t[r]+"/"+(e+".html").toLowerCase(),!1,function(e){n=e}),null!==n){parseUITemplate(e,n);break}return $t.ui[e]}function parseUI(e,t,n){var r=getUIName(e),i=importUIHTML(r);if(!i)return void removeNode(e);for(var o=slice.call(e.childNodes),a=slice.call(e.children),c=e.childNodes.length;c>0;c--)e.removeChild(e.childNodes[0]);var s=i.render(e,e.parentNode,o,a,null,n);t.next=s.elements.length}function getUI(e,t,n,r,i){var o=importUIHTML(e);if(o)return o.renderIn(null,t,n,r,i)}function renderIn(e,t,n,r,i,o){var a=importUIHTML(e);if(a)return a.renderIn(t,n,r,i,o)}function renderBefore(e,t,n,r,i,o){var a=importUIHTML(e);if(a)return a.renderBefore(t,n,r,i,o)}function parseXMP2(e){var t=parseXMP(e);isArray(t)?replaceNodeByNodes(e,t):removeNode(e)}function initCls(){var e=$t.clsNode;for(i=0;i<e.length;i++){var t=e[i].getAttribute("cls");e[i].removeAttribute("cls"),$t.styleClasses[t]&&(e[i].className+=" "+$t.styleClasses[t].join(" "))}e.length=0}function compileCls(){var e="";return forEach($t.styleClasses,function(t,n){for(var r=0;r<t.length;r++)e+='$t.styleClasses.push("'+n+'",'+propertyToJS(t[r])+");\n"}),e}function parseHTML(e){var t=document.createElement("ui:parseHTML");return t.innerHTML=e,initHTML(t.childNodes),takeChildNodes(t)}function isDefine(e){switch(!0){case e.hasAttribute("service"):case e.hasAttribute("ui"):case e.hasAttribute("class"):return!0}return!1}function parseXMP(e){return isDefine(e)?void parseDefine(e):parseHTML(getTemplate(e))}function getTemplate(e){switch(e.nodeName){case"TEMPLATE":case"XMP":case"SCRIPT":case"STYLE":return e.innerHTML;case"TITLE":return e.innerText;case"TEXTAREA":return e.defaultValue}}function isUI(e){return/UI:[A-Z\d]+/.test(e.nodeName)?!0:"SCRIPT"==e.nodeName&&"ui"==getAttr(e,"type")}function isTemplate(e){switch(e.nodeName){case"TEMPLATE":case"XMP":case"TITLE":return!0;case"SCRIPT":case"STYLE":case"TEXTAREA":if("xmp"==getAttr(e,"type"))return!0}return!1}function findTemplates(e){var t=[];return treeEach(e,"children",function(e){isTemplate(e)&&t.push(e)}),t}function compileDocument(e,t,n){var r=[];document.head.appendChild=function(e){r.push(e),Node.prototype.appendChild.call(this,e)};for(var i=document.body,o=findTemplates(i.children),a=[],c=0;c<o.length;c++)isDefine(o[c])?parseDefine(o[c]):a.push(o[c]);oldHTML=i.innerHTML;for(var c=0;c<a.length;c++)ret=parseHTML(getTemplate(a[c]));var s=compileCls(),l=compileUI(t);s+=l.script,removeNode(xmpStyle),e.innerHTML=s+e.innerHTML;for(var c in $t.jsScript)removeNode($t.jsScript[c]);for(var c=0;c<r.length;c++){var u=r[c].parentNode;u&&u.removeChild(r[c])}delete document.head.appendChild,s="";var d=document.childNodes;i.innerHTML=oldHTML;for(var c=0;c<d.length;c++)switch(d[c].nodeType){case 10:s+="<!DOCTYPE "+d[c].name+(d[c].publicId?" "+d[c].publicId:"")+(d[c].systemId?" "+d[c].systemId:"")+">";break;case 1:s+=d[c].outerHTML}n(s,l.compileJS)}function propertyToJS(e){var t=JSON.stringify({xx:e});return t=t.substring(6,t.length-1)}function renderDocument(e){renderDocument.beginTime=new Date,$t.body.length>0&&(document.body.innerHTML=$t.body);var t,n=findTemplates(document.body.children),r=[];for(t=0;t<n.length;t++)isDefine(n[t])?parseDefine(n[t]):r.push(n[t]);for(t=0;t<r.length;t++){var i=parseHTML(getTemplate(r[t]));replaceNodeByNodes(r[t],i)}initCls(),renderDocument.endTime=new Date}function compileUI(e){var t=[],n=[];if(isString(e)&&(e=trimLine(e).split(","),e[0].length>0))for(var r=0;r<e.length;r++)e[r]=trimLine(e[r]),importUIHTML(e[r]);for(var i in $t.ui)if($t.ui.hasOwnProperty(i)){var o=$t.ui[i],a=JSON.stringify(o).replace(/<\/script>/g,'</scr"+"ipt>');o.isInnerUI?t.push('$t.ui.define("'+i+","+a+')");'):(t.push('$t.importUIJS("'+i+'");'),n.push({name:i,script:'$t.ui.define("'+i+'",'+a+");"}))}return{script:t.join(""),compileJS:n}}function getNodesLength(e){if(e.parentNode)return e.parentNode.children.length;var t=getNodeIndex(e)-1;for(e=e.nextElementSibling;null!=e;)e=e.nextElementSibling,t++;return t}function getNodeIndex(e){var t=0;for(e=e.previousElementSibling;null!=e;)e=e.previousElementSibling,t++;return t}function getNodesLength2(e){if(e.parentNode)return e.parentNode.childNodes.length;var t=getNodeIndex2(e)-1;for(e=e.nextSibling;null!=e;)e=e.nextSibling,t++;return t}function getNodeIndex2(e){var t=0;for(e=e.previousSibling;null!=e;)e=e.previousSibling,t++;return t}function getUUID(e){e=e||6,e=parseInt(e,10),e=isNaN(e)?6:e;for(var t="0123456789abcdefghijklmnopqrstubwxyzABCEDFGHIJKLMNOPQRSTUVWXYZ",n=t.length-1,r="";e--;)r+=t[Math.round(Math.random()*n)];return r}function pushToLinks(e,t,n){var r;n.hasOwnProperty(e)?r=n[e]:(r=[],n[e]=r),r.push(t)}function Scope(e,t,n){this.__name__=n,this.__commentNode__=e,this.__actionNode__=e.parentNode,this.__parent__=t,this.__children__=[],this.__proto__=t,lockObject2(this),e.parentNode.scope=this,t.__children__.push(this),n&&(t[n]=this)}function RootScope(){this.__actionNode__=document.documentElement,this.__children__=[],lockObject2(this),document.scope=this,window.$rootScope=this}function UIScope(){}UIScope.prototype={create:function(e,t){var n=this.get(e);return e.parentNode!==n.__actionNode__?(n=new Scope(e,n,t),this.stack.push(n)):throwError("当前层不允许重复定义scope:"+t),n},get:function(e){if(!e)return $rootScope;for(;null!=e;){if(e.scope)return e.scope;e=e.parentNode}return $rootScope},stack:[new RootScope],cut:function(e){var t=e.__parent__;e.__parent__=null,removeItem(t.__children__,e),delete t[e.name]},link:function(e,t){var n=$t.uiScope.get(t);n&&(e.__parent__=n,n.__children__.push(e),name&&(n[name]=e))}};function UILink(){}UILink.prototype=new function(){var e='\\"onlink',t={on:function(e){var t;if(isString(e))t=e;else{if(!e.uiLinkUUID)return;t=e.uiLinkUUID}for(var n=this.uiLinks[t],r=slice.call(arguments,1),i=0;i<n.length;i++)n[i].apply(this,r)},create:function(t,n){t[e]=n},appendByTree:function(t,n){var r='\\"'+getUUID(8),i=this.uiLinks;treeEach(t.childNodes,"childNodes",function(n,o){8==n.nodeType&&isFunction(n[e])&&(pushToLinks(r,n[e],i),t.uiLinkUUID||(t.uiLinkUUID=r))})},appendByName:function(e,t){var n='\\"'+e;return pushToLinks(n,t,this.uiLinks),n},uiLinks:{}};return t};function UI(){Object.defineProperty(this,"__defineCallbacks__",{value:[],writable:!1,enumerable:!1,configurable:!1})}UI.prototype={onDefine:function(e,t){isFunction(t)&&isString(e)&&0!==e.length&&(this.__defineCallbacks__.push({name:e,fn:t}),this.hasOwnProperty(e)&&t(this[e]))},emitOnDefine:function(e,t){for(var n=this.__defineCallbacks__,r=0;r<n.length;r++)n[r].name!==e&&"*"!==n[r].name||n[r].fn(t)},define:function(e,t,n){this[e]=new UITemplate(e,t,n),this.emitOnDefine(e,this[e])}};function Service(){Object.defineProperty(this,"__defineCallbacks__",{value:[],writable:!1,enumerable:!1,configurable:!1})}Service.prototype={require:function(e){return this.hasOwnProperty[e]||(this[e]=getService(e)),this[e]},onDefine:UI.prototype.onDefine,emitOnDefine:UI.prototype.emitOnDefine,define:function(name,s){try{this[name]=eval("("+s+")")}catch(e){_catch(e)}this.emitOnDefine(name,this[name])}};function UITeam(){}UITeam.prototype=new function(){var e={push:function(e,t,n,r){var i;return this.hasOwnProperty(e)?(i=this[e],i.checkEvents.push(n),i.missingCheckEvents.push(r),i.groups.push(t)):(i={call:function(){for(var e=i.checkEvents,t=getNodeIndex(this),n=0;n<e.length;n++){var r=i.groups[n][t];r?e[n].call(r):i.missingCheckEvents[n]()}},checkEvents:[n],missingCheckEvents:[r],groups:[t]},this[e]=i),i.call}};return e};function newKeyArrayObject(e){return newObject(e,newKeyArrayObject.prototype)}newKeyArrayObject.prototype={push:function(e,t){this.hasOwnProperty(e)||(this[e]=[]),this[e].push(t)},clear:function(){forEach(this,function(e,t,n){delete n[t]},this,!1)},getKeyArray:function(){return getKeyArray(this)}};function makeCompileString(){var e=$t.turtleScriptElement.cloneNode();return e.setAttribute("compile",""),e.setAttribute("compileuilist",getKeyArray($t.ui).join(",")),e.outerHTML}function beforeReady(){var scriptNode=$t.turtleScriptElement=document.scripts[document.scripts.length-1],compile=takeAttr(scriptNode,"compile",null),load=getAttr(scriptNode,"load",null),sciript=scriptNode.innerHTML,baseuipath=takeAttr(scriptNode,"baseuipath",null),extend=takeAttr(scriptNode,"extend",null),compilename=takeAttr(scriptNode,"compilename",null),compileuilist=takeAttr(scriptNode,"compileuilist",null);baseuipath&&(turtle.config.baseUIPath=baseuipath.split(",")),extend&&turtle.extend(window,turtle.fn),sciript.length>0&&execTurtleScript(scriptNode,null,null),null!=compile&&"1"!=getQueryString("turtle_nocompile")&&$t.xhr.get(scriptNode.src+".setup",!1,function(text){eval("compile="+text)});var resume=compile&&compile.isOn&&compile.url?r1:r2;if(load){var loads=load.split(","),i=0,fnLoad=function(){i++,i<loads.length?$t.includeJSFiles(loads[i],fnLoad):resume()};$t.includeJSFiles(loads[0],fnLoad)}else resume();function r1(){$t.ready(function(){turtle.compileDocument(scriptNode,compileuilist,function(e,t){compilename||(compilename=getNameByURL(getNameByLocation()),/\./.test(compilename)&&(compilename=compilename.split(".")[0]));var n=compile.url+"?htmlName="+compilename,r=document.body;r.innerHTML='<div style="background-color:#fff;position:absolute;left:0;right:0;bottom:0;top:0;">开始编译页面</div>';var i=r.children[0];$t.xhr.post(n,e,!1,function(e){var n=document.createElement("br"),r=document.createElement("span"),o=1e3;r.innerHTML="?",r.style.color="#f00",i.appendChild(n),i.appendChild(n.cloneNode()),i.appendChild(document.createTextNode("刷新页面剩余时间：")),i.appendChild(r),i.appendChild(n.cloneNode()),i.appendChild(n.cloneNode()),i.appendChild(document.createTextNode(e));for(var a=0;a<t.length;a++){var c=compile.url+"?uiName="+t[a].name;$t.xhr.post(c,t[a].script,!1,function(e){i.appendChild(n.cloneNode()),i.appendChild(document.createTextNode(e))})}setTimeout(function(){window.location.href=appendQueryString("turtle_nocompile","1")},o),setInterval(function(){o-=100,r.innerHTML=o/1e3},100)})})})}function r2(){$t.ready(function(){$t.renderDocument(),$t.readyByRenderDocument.isReady=!0})}}function ready(e){return $t.readyByRenderDocument.isReady||readyRE.test(document.readyState)&&null!==document.body?e():window.addEventListener("DOMContentLoaded",function(){null!==document.body&&(window.removeEventListener("DOMContentLoaded",arguments.callee),e())},!1),this}function ReadyObject(){var e=!1,t={on:function(t){isFunction(t)&&(e?t():this.readyFunctions.push(t))},readyFunctions:[]};return Object.defineProperty(t,"isReady",{get:function(){return e},set:function(t){for(e=t;this.readyFunctions.length>0;)this.readyFunctions.shift()()}}),t}var fn={};fn.$$=$$,fn.onTry=onTry,fn.getOnTry=getOnTry,fn.getClosure=getClosure,fn.getClosureTry=getOnTry,fn.addClass=addClass,fn.addClasses=addClasses,fn.removeClass=removeClass,fn.removeClasses=removeClasses,fn.replaceClass=replaceClass,fn.toggleClass=toggleClass,fn.isRegExp=isRegExp,fn.isDate=isDate,fn.isNumber=isNumber,fn.isString=isString,fn.isFunction=isFunction,fn.isObject=isObject,fn.isFinite=isFinite,fn.isUndefined=isUndefined,fn.isArray=isArray,fn.isRepeat=isRepeat,fn.isArrayLike=isArrayLike,fn.toArray=toArray,fn.moveArray=moveArray,fn.getRect=getRect,fn.encodeHTML=encodeHTML,fn.decodeHTML=decodeHTML,fn.idle=idle,fn.elementDOMdistance=elementDOMdistance,fn.elementInElement=elementInElement,fn.debounce=debounce,fn.getAttr=getAttr,fn.extend=extend,fn.extendConst=extendConst,fn.lockObject=lockObject,fn.lockObject2=lockObject2,fn.getBind=getBind,fn.compact=compact,fn.flatten=flatten,fn.camelize=camelize,fn.dasherize=dasherize,fn.takeOutChildNodes=takeOutChildNodes,fn.takeChildNodes=takeChildNodes,fn.trim=trim,fn.trimLine=trimLine,fn.map=map,fn.each=each,fn.forEach=forEach,fn.forEachSorted=forEachSorted,fn.treeEach=treeEach,fn.scriptToJSON=scriptToJSON,fn.replaceNodeByNodes=replaceNodeByNodes,fn.replaceNodeByNode=replaceNodeByNode,fn.replaceNodeByString=replaceNodeByString,fn.insertNodesBefore=insertNodesBefore,fn.replaceByObjectAttr=replaceByObjectAttr,fn.replaceByNodeAttr=replaceByNodeAttr,fn.appendNodes=appendNodes,fn.nodesToString=nodesToString,fn.parseBool=parseBool,fn.getUUID=getUUID,fn.handleWebkitRrror=handleWebkitRrror,fn.getNodeIndex=getNodeIndex,fn.getNodeIndex2=getNodeIndex2,fn.getNameByURL=getNameByURL,fn.getFileNameByURL=getFileNameByURL,fn.getNameByLocation=getNameByLocation,fn.execTurtleScript=execTurtleScript,fn.lowercase=lowercase,fn.uppercase=uppercase,fn.getDPI=getDPI,fn.removeNode=removeNode,fn.ReadyObject=ReadyObject,fn.objectChange=objectChange,fn.objectPropertyChange=objectPropertyChange,fn.bindProperty=bindProperty,fn.bindElementProperty=bindElementProperty,fn.getUIName=getUIName,fn.isUI=isUI,fn.repeatCall=repeatCall,fn.removeItem=removeItem,fn.UITemplate=UITemplate,fn.importUIJS=importUIJS,fn.onPropertyChange=onPropertyChange,fn.bindNodeProperty=bindNodeProperty,fn.newHashObject=newHashObject,fn.newArrayObject=newArrayObject,fn.includeJSFiles=includeJSFiles,fn.bindElementPropertyByName=bindElementPropertyByName,fn.log=log,fn.bp=bp,fn.camelCase=camelCase,fn.execByScope=execByScope,fn.execTemplateScript=execTemplateScript,fn.toPercent=toPercent,fn.getStateFunction=getStateFunction;function Turtle(){this.config={baseUIPath:["ui"],baseServicePath:"service",debugMode:2},this.event={onerror:function(e){log(e),alert(e)}},this.getUI=getUI,this.renderIn=renderIn,this.renderBefore=renderBefore,this.parseHTML=parseHTML,this.parseXMP=parseXMP,this.renderDocument=renderDocument,this.compileUI=compileUI,this.compileDocument=compileDocument,this.initCls=initCls,this.initHTML=initHTML,this.ui=new UI,this.jsScript=newHashObject("JSHash"),this.styleClasses=newKeyArrayObject("StyleClasses"),this.refNode=newKeyArrayObject("RefNode"),this.clsNode=newArrayObject("ClassNode"),this.getNode=newHashObject("GetNode"),this.service=new Service,this.body="",this.uiTeam=new UITeam,this.uiLink=new UILink,this.uiScope=new UIScope,this.xhr=new XHR,Object.defineProperty(this,"rootComponents",{get:function(){return new RootComponents}}),this.ready=ready,this.readyByRenderDocument=new ReadyObject,this.fn=fn,this.turtleScriptElement="",this.makeCompileString=makeCompileString,this.renderParser={attributeParser:attributeParser,elementParser:elementParser},this.require=require,this.isIE=isIE}Turtle.prototype=fn,turtle=$t=new Turtle,beforeReady()}();